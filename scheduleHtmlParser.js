let html = String.raw`<table class="table" id="scheduleTable" name="mytable">
			
<tbody>
    
    
    <tr>
        
        
        
        
            <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">勘查地球化学</font><br>李顺达 <br>1-16[1-2]<br>南2#101</div>
            
        </td>
        
            <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地球化学负异常的成矿意义</font><br>李顺达 <br>08[1-2]<br>实验-南3#实验楼303</div>
            
        </td>
        
            <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质观测点记录</font><br>马静辉 <br>08[1-3]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">勘查地球化学</font><br>李顺达 <br>1-16 单 [1-2]<br>南2#101</div>
            
        </td>
        
            <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k41">
                </div>
            
        </td>
        
            <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k51">
                </div>
            
        </td>
        
            <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k61">
                </div>
            
        </td>
        
    </tr>
    

    <tr>
        
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">指示元素的选择</font><br>李顺达 <br>09[3-4]<br>实验-南3#实验楼303</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">背景值与异常界限的确定</font><br>李顺达 <br>10[3-4]<br>实验-南3#实验楼303</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">勘查地球化学数据处理的统计分析（一）：判别分析</font><br>李顺达 <br>11[3-4]<br>实验-南3#实验楼303</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">勘查地球化学数据处理的统计分析（二）：聚类分析</font><br>李顺达 <br>12[3-4]<br>实验-南3#实验楼303</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">化探方法的选择，采样布局及异常评价</font><br>李顺达 <br>13[3-4]<br>实验-南3#实验楼303</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质观测路线规划</font><br>马静辉 <br>01[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质观测路线规划</font><br>马静辉 <br>02[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质观测点记录</font><br>马静辉 <br>07[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质实测剖面编录</font><br>马静辉 <br>05[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质实测剖面编录</font><br>马静辉 <br>06[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质图像采集记录</font><br>马静辉 <br>03[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质图像采集记录</font><br>马静辉 <br>04[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质样品、标本采集记录</font><br>马静辉 <br>09[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质样品、标本采集记录</font><br>马静辉 <br>10[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">实际材料图编录</font><br>马静辉 <br>11[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">实际材料图编录</font><br>马静辉 <br>13[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质平面图编录</font><br>马静辉 <br>14[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质平面图编录</font><br>马静辉 <br>15[3-5]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">地质平面图编录</font><br>马静辉 <br>16[3-5]<br>实验-南3#实验楼310</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k32">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">毛泽东思想和中国特色社会主义理论体系概论</font><br>马玉欢 <br>3,6,9,12,15[3-5]<br>超星尔雅平台</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">毛泽东思想和中国特色社会主义理论体系概论</font><br>马玉欢 <br>1-2,4-5,7-8,10-11,13-14,16[3-5]<br>F区303</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k52">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k62">
                </div>
                                    
        </td>
        
    </tr>
    
    
    <!-- 
    </tbody>
    <tbody block="block">
     -->
    
    <tr>
        
        
        
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">与镁铁-超镁铁质岩有关矿床中矿石的观察认识</font><br>陈梦婷 <br>01[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">与中酸性岩有关矿床中矿石的观察认识</font><br>陈梦婷 <br>02[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">与中酸性岩有关矿床中矿石的观察认识</font><br>陈梦婷 <br>03[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">海相火山岩型铁矿床常见矿物及岩矿石的观察认识</font><br>陈梦婷 <br>04[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">海相火山岩型铁矿床常见矿物及岩矿石的观察认识</font><br>陈梦婷 <br>05[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">海相火山岩型铁矿床常见矿物及岩矿石的观察认识</font><br>陈梦婷 <br>06[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">火山岩型块状硫化物（VMS）矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>07[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">火山岩型块状硫化物（VMS）矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>08[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">火山岩型块状硫化物（VMS）矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>09[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">矽卡岩型Cu-Au矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>10[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">矽卡岩型Cu-Au矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>11[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">矽卡岩型Cu-Au矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>12[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">矽卡岩型Cu-Au矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>13[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">黑色岩系型金矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>14[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">黑色岩系型金矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>15[6-7]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">黑色岩系型金矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>16[6-7]<br>实验-南3#实验楼301</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">成矿规律与新疆典型矿床</font><br>卡哈尔·尼牙孜 <br>9-16[6-7]<br>南2#217</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k33">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k43">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k53">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k63">
                </div>
                                    
        </td>
        
    </tr>
    
    <tr>
        
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">实际材料图编录</font><br>马静辉 <br>12[8-10]<br>实验-南3#实验楼310</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">与镁铁-超镁铁质岩有关矿床中矿石的观察认识</font><br>陈梦婷 <br>01[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">与中酸性岩有关矿床中矿石的观察认识</font><br>陈梦婷 <br>03[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">海相火山岩型铁矿床常见矿物及岩矿石的观察认识</font><br>陈梦婷 <br>05[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">火山岩型块状硫化物（VMS）矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>07[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">火山岩型块状硫化物（VMS）矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>09[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">矽卡岩型Cu-Au矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>11[8-9]<br>实验-南3#实验楼301</div><div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">黑色岩系型金矿床矿物及岩矿石的观察认识</font><br>陈梦婷 <br>13[8-9]<br>实验-南3#实验楼301</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k24">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k34">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div style="padding-bottom:5px;clear:both;"><font style="font-weight: bolder">成矿规律与新疆典型矿床</font><br>卡哈尔·尼牙孜 <br>9-16[8-9]<br>南2#104</div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k54">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k64">
                </div>
                                    
        </td>
        
    </tr>
    
    <!-- 
    </tbody>
    <tbody block="block">
     -->
    
    <tr>
        
        
        
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k15">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k25">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k35">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k45">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k55">
                </div>
                                    
        </td>
        
        <td class="td" style="width:14%;">
            
                <div class="div_nokb" id="k65">
                </div>
                                    
        </td>
        
    </tr>
    
</tbody>
</table>`

const cheerio = require('cheerio')
const $ = cheerio.load(html)

// class， 写在scheduleHtmlParser外的函数可能导致手机版无法运行
function scheduleHtmlParser(html) {
    function Section() {
        this.section = -1;
        this.startTime = undefined; // 这里不要弄成空字符串
        this.endTime = undefined;
    }
    function Course() {
        this.name = ""; // 课程
        this.position = ""; // 教室
        this.teacher = ""; // 老师
        this.weeks = []; // 第几周
        this.day = "-1"; // 星期几
        this.sections = []; // 第几节
    }
    let _range = function(start, end) {
        // 根据范围生成 [start, end] 的数
        let result = []
        for (let i = Number(start); i <= Number(end); ++i) {
            result.push(i)
        }
        return result
    }
    // 防止中文被转义
    var $ = cheerio.load(html, { decodeEntities: false })
    let result = []
    // 解析课程表
    let rowCourse = $('#scheduleTable tr')
    for (let row = 0; row < rowCourse.length; ++row) {
        let lines = $('td', rowCourse[row])
        for (let col = 0; col < lines.length; ++col) {
            // 一个 div 是一个课
            // 这里如果有多个div，意味着同时不同周
            let _cos = $('div', lines[col])
            // 检查这节是否没课
            if ($('.div_nokb', lines[col]).length) continue;
            // 解析字符串
            for (let c = 0; c < _cos.length; ++c) {
                let _course = new Course;
                _course.day = String(col + 1)
                // let _cheerio = cheerio.load(_cos.html)
                _course.name = $('font', _cos[c]).text()
                // 检查_course.name 是否超过了21个字符
                if (_course.name.length > 21) {
                    _course.name = _course.name.slice(0, -3) + "..."
                }
                let info = $(_cos[c]).html().split('br')
                _course.teacher = info[1].replace('>', '').replace(' <', '')
                _course.position = info[3].replace('</div>', '').replace('>', '').replace('</', '').trim()
                // 检查周数
                // 周数有以下几种表示方法：1-16; 08; 3,6,9,12,15; 1-2,4-5,7-8,10-11,13-14,16[3-5]; 1-16 单 
                let weeks = info[2].split('[')[0].split(' ')[0].replace('>', '')
                // 先检查逗号
                let weeks_comma = weeks.split(',')
                for (let comma = 0; comma < weeks_comma.length; ++comma) {
                    // 检查连接号
                    let weeks_connection = weeks_comma[comma].split('-');
                    // _course.weeks.push()
                    //todo: 单双周检测
                    _course.weeks = _course.weeks.concat(_range(weeks_connection[0], weeks_connection.length == 1 ? weeks_connection[0] : weeks_connection[1]))
                }
                // 单双周检测
                let ods_weeks = info[2].split(' ')
                if (ods_weeks.length >= 2) {
                    let ods_week = ods_weeks[1]
                    if (ods_week === "单") {
                        let ods = []
                        for (let _ods = 0; _ods < _course.weeks.length; ++_ods) {
                            if (_course.weeks[_ods] % 2 === 0) continue;
                            ods.push(_course.weeks[_ods])
                        }
                        _course.weeks = ods
                    }
                    if (ods_week === "双") {
                        let ods = []
                        for (let _ods = 0; _ods < _course.weeks.length; ++_ods) {
                            if (_course.weeks[_ods] % 2 === 1) continue;
                            ods.push(_course.weeks[_ods])
                        }
                        _course.weeks = ods
                    }
                }
                // 检测节数
                // 节数有以下表示方法：[1-2]; 单 [1-2]
                let section = info[2].split('[')[1].replace(']', '')
                for (let _sec = Number(section[0]); _sec <= Number(section[2]); ++_sec) {
                    let _section = new Section
                    _section.section = _sec
                    _course.sections.push(_section)
                }
                result.push(_course)
            }
        }
    }
    // 对文本进行格式化
    let msg = {
        "courseInfos": JSON.parse(JSON.stringify(result))
    }
    // 这里返回对象
    return msg

}

// 官方带的解析例子
function testParser(text) {
    let isTrue = 1
    if (text.courseInfos && text.courseInfos.length > 0) {
        text.courseInfos.forEach(function (item) {
            if (!item.name || !item.weeks || item.weeks.length == 0) {
                console.log(item)
                isTrue = 0
            }
        })
        return isTrue
    } else {
        return 0
    }
}
console.log(scheduleHtmlParser(html))